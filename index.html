<!DOCTYPE html>
<html lang="nl">
  <head>
    <meta charset="UTF-8" />
    <title>Dairy Campus AR Demo</title>

    <!-- ✅ correcte A-Frame versie -->
    <script src="https://aframe.io/releases/1.4.2/aframe.min.js"></script>

    <!-- ✅ MindAR image tracking -->
    <script src="https://cdn.jsdelivr.net/npm/mind-ar@1.2.3/dist/mindar-image-aframe.prod.js"></script>

    <style>
      body { margin: 0; overflow: hidden; background: #000; color: white; }
      #loading { position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%); }
    </style>
  </head>

  <body>
    <div id="loading">Weerstation laden...</div>

    <a-scene
      mindar-image="imageTargetSrc: ./targets/weatherstation.mind;"
      embedded
      color-space="sRGB"
      renderer="colorManagement: true;"
      vr-mode-ui="enabled: false"
      device-orientation-permission-ui="enabled: true"
    >
      <a-assets></a-assets>

      <!-- target -->
      <a-entity mindar-image-target="targetIndex: 0">
        <a-plane color="#222" width="1.6" height="0.9" opacity="0.8" position="0 0 0.1"></a-plane>
        <a-text id="temp" value="Temp: -- °C" color="#00FFAA" position="-0.7 0.3 0.11" align="left"></a-text>
        <a-text id="hum"  value="Vocht: -- %" color="#00FFAA" position="-0.7 0 0.11" align="left"></a-text>
        <a-text id="wind" value="Wind: -- m/s" color="#00FFAA" position="-0.7 -0.3 0.11" align="left"></a-text>
      </a-entity>

      <a-camera position="0 0 0"></a-camera>
    </a-scene>

    <script>
      const loader = document.getElementById('loading');
      window.addEventListener("load", () => loader.remove());

      async function updateWeather() {
        try {
          // tijdelijk dummydata ipv fetch()
          const data = { temperature: 12.7, humidity: 76, windspeed: 3.8 };

          document.querySelector("#temp").setAttribute("value", `Temp: ${data.temperature} °C`);
          document.querySelector("#hum").setAttribute("value", `Vocht: ${data.humidity} %`);
          document.querySelector("#wind").setAttribute("value", `Wind: ${data.windspeed} m/s`);
        } catch (err) {
          console.warn("API error:", err);
        }
      }

      setInterval(updateWeather, 5000);
      updateWeather();
    </script>
  </body>
</html>
